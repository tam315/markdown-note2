# Software Design 202512

## ID管理

**実体**(Entity)とは、現実世界に存在する個人、組織、デバイスなどを指す。
アプリやAIエージェントなどの電子的な存在も含まれる。

**属性**(Attribute)とは、実体の特徴や性質を表す情報のこと。
氏名、生年月日、組織名など。

**デジタルID**(デジタルアイデンティティ)とは、ある実体に関する属性の集合である。
現実世界の様々な実体をデジタル空間上で表現し、区別できるようにするために使う。

デジタルIDの管理には、ライフサイクル管理とアクセス管理の大きく2つの柱がある。

### ライフサイクル管理

ISO/IEC 24760-1 に標準が定義されている。
unknown/established/active/suspended/archivedなどの**状態**が定義されている。

**身元確認・ID発行機能**は、IDの申請者から必要な情報を集め、実在性を確認後、IDを発行する機能。
求められる身元確認保証レベルに応じて、自己申告からeKYCまで様々な確認方法がある。
また、システムの特性によって必要な属性は大きく異なる。

**ライフサイクルマネジメント機能**は、各種のイベントに応じてIDの状態を変更したり、
実体の変化にあわせて属性を更新したりする機能。
属性には、パスワード等のクレデンシャル、認可情報、その他(名前や連絡先など)が含まれる。
ビジネス要件に応じて独自性が必要になりがちな部分である。
アカウントリカバリーもここに含まれる。

### アクセス管理

誰が、何に、どの条件で、どこまでアクセスしていいかを管理する。
なお、ライフサイクル管理によりIDが最新化されているのが前提となる。

**当人認証機能**は、その人がIDの所有者であることを確認する機能。
要件に応じて強度や利便性は変わる。
独自性はほぼ必要ない部分なので、独自実装せずにIDaaSやSSO製品を使うのがよい。
個々のシステムではなく、専用のID管理システムで一括して当人認証を行う方法を**フェデレーションモデル**という。

**認可・アクセスコントロール機能**は、認可情報に基づき、
利用者が特定のリソースにアクセスすることができるか判断する機能。
認可情報の管理自体はライフサイクルマネジメント機能で行うのに対し、
ここでは実際に使えるかどうかの判定を行っている点に注意。
方法には以下の3つがある。

- IBAC / Identity-based access management / 実体で判定
- RBAC / Role-based access management / 実体に割り当てたロールで判定
- ABAC / Attribute-based access management / 属性で判定

**認証連携機能**は、前述の2つの機能の結果を他のシステムに伝える機能。
イントラネットではSSO製品の備える独自の連携方式を手軽に使い、
クラウドサービスとの連携ではSAML/OIDCなどを使うのがよさげ。

### 共通機能

**証跡管理機能**は、ID管理システム内で発生した各種イベントを記録・保存・検索する機能。
インシデント対応や内部統制監査に必要となる。

**ガバナンス機能**は、利用が適切に行われているか随時確認し、適正化する機能。
不正アクセス、過大な権限付与、管理者権限乱用などを検出する。

### EIAMとCIAM

**EIAM** (Enterprise Identity and Access Management) は、企業内の従業員やパートナーのID管理を対象とする。
利便性よりも内部統制とリスク管理を重視する。
ID発行時には、対面や公式証明書などによる厳格な身元確認を行う。
管理者がライフサイクルを管理し、最小権限のみを与える。
当人認証では、多要素認証が一般的に採用される。
認証連携では、利便性と統制のため、SSOやフェデレーションが多用される。
認可やアクセスコントロールは、RBACやABACにより細かく制御される。
証跡管理機能とガバナンス機能は必須。

**CIAM** (Customer Identity and Access Management) は、顧客や一般ユーザーのID管理を対象とする。
利便性とセキュリティのバランスを重視し、UXを最適化する。
ID発行時には、最低限の身元確認しか行わない。
プライバシー保護やポリシーへの同意が重要となる。
サービス利用の進展に応じて属性を足していく「プログレッシブプロファイリング」が採用される。
当人認証では、利便性と安全性のバランスを考慮した方法が選ばれる。
認証連携では、OIDCなど標準規格が使われる。
認可やアクセスコントロールの粒度はおおざっぱである。
証跡管理では、認証の成否に加え、不正アクセスに備え、認証後の操作ログなどをとっておくのが大事。
ガバナンスでは、一定期間利用のないユーザーのアカウント削除などを行うとよい。

| 項目                           | EIAM（Enterprise IAM）               | CIAM（Customer IAM）                                 |
| ------------------------------ | ------------------------------------ | ---------------------------------------------------- |
| **対象**                       | 企業内の従業員やパートナー           | 顧客や一般ユーザー                                   |
| **基本方針**                   | 内部統制とリスク管理を重視           | 利便性とセキュリティのバランス、UX最適化             |
| **ID発行時の身元確認**         | 対面や公式証明書などによる厳格な確認 | 最低限の確認のみ                                     |
| **ライフサイクル管理**         | 管理者が管理し、最小権限のみを付与   | プログレッシブプロファイリング（段階的に属性を追加） |
| **プライバシー**               | −                                    | プライバシー保護やポリシー同意が重要                 |
| **当人認証**                   | 多要素認証が一般的                   | 利便性と安全性のバランスを考慮                       |
| **認証連携**                   | SSO・フェデレーションが多用          | OIDCなど標準規格を使用                               |
| **認可・アクセスコントロール** | RBAC・ABACにより細かく制御           | 粒度はおおざっぱ                                     |
| **証跡管理**                   | 必須                                 | 認証の成否に加え、認証後の操作ログも重要             |
| **ガバナンス**                 | 必須                                 | 一定期間未利用アカウントの削除など                   |
